{"version":3,"file":"NegociacaoDao.js","names":["Negociacao","NegociacaoDao","connection","_connection","_store","negociacao","Promise","resolve","reject","request","transaction","objectStore","add","onsuccess","e","onerror","console","log","target","error","cursor","openCursor","negociacoes","atual","result","dado","value","push","_data","_quantidade","_valor","clear","targe"],"sources":["../../app-es6/dao/NegociacaoDao.js"],"sourcesContent":["import { Negociacao } from \"../models/Negociacao.js\";\r\n\r\nexport class NegociacaoDao{\r\n\r\n  constructor(connection){\r\n    this._connection = connection;\r\n    this._store = 'negociacoes';\r\n  }\r\n\r\n  adiciona(negociacao) {\r\n\r\n            return new Promise((resolve,reject)=>{\r\n\r\n              let request =  this._connection\r\n                          .transaction([this._store], 'readwrite')\r\n                          .objectStore(this._store)\r\n                          .add(negociacao);\r\n\r\n                request.onsuccess = e =>{\r\n                      resolve();\r\n                }; \r\n                \r\n                request.onerror = e =>{\r\n                      console.log(e.target.error);\r\n                      reject('Não foi possível adicionar a negociação');\r\n                };\r\n            });\r\n  }\r\n\r\n\r\n  listaTodos() {\r\n\r\n            return new Promise((resolve, reject)=>{\r\n                  let cursor =  this._connection\r\n                                .transaction([this._store], 'readwrite')\r\n                                .objectStore(this._store)\r\n                                .openCursor();\r\n\r\n                    let negociacoes = [];\r\n                  \r\n                  cursor.onsuccess = e => {\r\n                      let atual = e.target.result;\r\n                      if(atual){\r\n                        let dado = atual.value;\r\n                        negociacoes.push(new Negociacao(dado._data, dado._quantidade, dado._valor));\r\n\r\n                        atual.continue();\r\n                      }else {\r\n                        resolve(negociacoes);\r\n                      }\r\n                  }    \r\n\r\n                    cursor.onerror = e => {\r\n                          console.log(e.target.error);\r\n                          reject(\"Não foi possível adicionar a negociação\")\r\n                    }       \r\n            })\r\n  }\r\n  \r\n\r\n  apagaTodos(){\r\n\r\n            return new Promise((resolve, reject) => {\r\n\r\n                let request = this._connection\r\n                             .transaction([this._store], 'readwrite')\r\n                             .objectStore(this._store)\r\n                             .clear();\r\n\r\n\r\n                    request.onsuccess = e => resolve('Negociacões apagadas');\r\n                    request.onerror = e => { \r\n                            console.log(e.targe.error);\r\n                            reject('Negociações não podem ser apagadas');\r\n                    };\r\n\r\n            });\r\n  }\r\n\r\n\r\n\r\n}"],"mappings":";;;;;;;;;;;;;;;MAASA,U,uBAAAA,U;;;+BAEIC,a;QAEX,uBAAYC,UAAZ,EAAuB;UAAA;;UACrB,KAAKC,WAAL,GAAmBD,UAAnB;UACA,KAAKE,MAAL,GAAc,aAAd;QACD;;;;iBAED,kBAASC,UAAT,EAAqB;YAAA;;YAEX,OAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAASC,MAAT,EAAkB;cAEnC,IAAIC,OAAO,GAAI,KAAI,CAACN,WAAL,CACFO,WADE,CACU,CAAC,KAAI,CAACN,MAAN,CADV,EACyB,WADzB,EAEFO,WAFE,CAEU,KAAI,CAACP,MAFf,EAGFQ,GAHE,CAGEP,UAHF,CAAf;;cAKEI,OAAO,CAACI,SAAR,GAAoB,UAAAC,CAAC,EAAG;gBAClBP,OAAO;cACZ,CAFD;;cAIAE,OAAO,CAACM,OAAR,GAAkB,UAAAD,CAAC,EAAG;gBAChBE,OAAO,CAACC,GAAR,CAAYH,CAAC,CAACI,MAAF,CAASC,KAArB;gBACAX,MAAM,CAAC,yCAAD,CAAN;cACL,CAHD;YAIH,CAfM,CAAP;UAgBT;;;iBAGD,sBAAa;YAAA;;YAEH,OAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAmB;cAChC,IAAIY,MAAM,GAAI,MAAI,CAACjB,WAAL,CACCO,WADD,CACa,CAAC,MAAI,CAACN,MAAN,CADb,EAC4B,WAD5B,EAECO,WAFD,CAEa,MAAI,CAACP,MAFlB,EAGCiB,UAHD,EAAd;;cAKE,IAAIC,WAAW,GAAG,EAAlB;;cAEFF,MAAM,CAACP,SAAP,GAAmB,UAAAC,CAAC,EAAI;gBACpB,IAAIS,KAAK,GAAGT,CAAC,CAACI,MAAF,CAASM,MAArB;;gBACA,IAAGD,KAAH,EAAS;kBACP,IAAIE,IAAI,GAAGF,KAAK,CAACG,KAAjB;kBACAJ,WAAW,CAACK,IAAZ,CAAiB,IAAI3B,UAAJ,CAAeyB,IAAI,CAACG,KAApB,EAA2BH,IAAI,CAACI,WAAhC,EAA6CJ,IAAI,CAACK,MAAlD,CAAjB;kBAEAP,KAAK,YAAL;gBACD,CALD,MAKM;kBACJhB,OAAO,CAACe,WAAD,CAAP;gBACD;cACJ,CAVD;;cAYEF,MAAM,CAACL,OAAP,GAAiB,UAAAD,CAAC,EAAI;gBAChBE,OAAO,CAACC,GAAR,CAAYH,CAAC,CAACI,MAAF,CAASC,KAArB;gBACAX,MAAM,CAAC,yCAAD,CAAN;cACL,CAHD;YAIP,CAxBM,CAAP;UAyBT;;;iBAGD,sBAAY;YAAA;;YAEF,OAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;cAEpC,IAAIC,OAAO,GAAG,MAAI,CAACN,WAAL,CACAO,WADA,CACY,CAAC,MAAI,CAACN,MAAN,CADZ,EAC2B,WAD3B,EAEAO,WAFA,CAEY,MAAI,CAACP,MAFjB,EAGA2B,KAHA,EAAd;;cAMItB,OAAO,CAACI,SAAR,GAAoB,UAAAC,CAAC;gBAAA,OAAIP,OAAO,CAAC,sBAAD,CAAX;cAAA,CAArB;;cACAE,OAAO,CAACM,OAAR,GAAkB,UAAAD,CAAC,EAAI;gBACfE,OAAO,CAACC,GAAR,CAAYH,CAAC,CAACkB,KAAF,CAAQb,KAApB;gBACAX,MAAM,CAAC,oCAAD,CAAN;cACP,CAHD;YAKP,CAdM,CAAP;UAeT"}