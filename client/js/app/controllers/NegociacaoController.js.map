{"version":3,"file":"NegociacaoController.js","names":["currentInstance","negociacaoController","DateHelper","Bind","ListaNegociacoes","Mensagem","MensagemView","Negociacao","NegociacoesView","NegociacaoService","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_service","_init","lista","then","negociacoes","forEach","negociacao","adiciona","erro","texto","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","apaga","esvazia","console","log","textoParaData","value","parseInt","parseFloat","coluna","ordena","a","b","focus"],"sources":["../../app-es6/controllers/NegociacaoController.js"],"sourcesContent":["import { DateHelper} from \"../helpers/DateHelper.js\";\nimport { Bind } from \"../helpers/Bind.js\";\nimport { ListaNegociacoes } from \"../models/ListaNegociacoes.js\";\nimport { Mensagem } from \"../models/Mensagem.js\";\nimport { MensagemView } from \"../views/MensagemView.js\";\nimport { Negociacao } from \"../models/Negociacao.js\";\nimport { NegociacoesView } from \"../views/NegociacoesView.js\";\nimport { NegociacaoService } from \"../services/NegociacaoService.js\";\n\nexport class NegociacaoController {\n    \n    constructor() {\n        \n        let $ = document.querySelector.bind(document);\n        \n        this._inputData = $('#data');\n        this._inputQuantidade = $('#quantidade');\n        this._inputValor = $('#valor');\n         \n        this._listaNegociacoes = new Bind(\n            new ListaNegociacoes(), \n            new NegociacoesView($('#negociacoesView')), \n            'adiciona', 'esvazia','ordena');\n       \n        this._mensagem = new Bind(\n            new Mensagem(), new MensagemView($('#mensagemView')),\n            'texto');       \n        this._service =  new NegociacaoService();\n\n        this._init();    \n        \n    }\n\n    _init() {\n\n        this._service\n            .lista()\n            .then(negociacoes =>\n                  negociacoes.forEach(negociacao =>\n                    this._listaNegociacoes.adiciona(negociacao)))\n            .catch(erro => this._mensagem.texto = erro );\n\n            setInterval(()=>{\n                    this.importaNegociacoes();\n            },3500)                         \n    }\n\n    \n    adiciona(event) {\n        event.preventDefault();\n\n        let negociacao = this._criaNegociacao();\n\n        this._service\n            .cadastra(negociacao)\n            .then(mensagem => {\n                this._listaNegociacoes.adiciona(negociacao);\n                this._mensagem.texto = mensagem ; \n                this._limpaFormulario();   \n            }).catch(erro => this._mensagem.texto = erro);\n    }\n\n\n    importaNegociacoes(){\n        \n        this._service\n            .importa(this._listaNegociacoes.negociacoes)\n            .then(negociacoes => negociacoes.forEach(negociacao =>{\n                this._listaNegociacoes.adiciona(negociacao)\n                this._mensagem.texto = 'Negociações importadas com sucesso'\n            }))\n            .catch(erro => this._mensagem.texto = erro);\n    }           \n\n    apaga() {\n        this._service\n            .apaga()\n            .then(mensagem => {\n                this._mensagem.texto = mensagem;\n                this._listaNegociacoes.esvazia();\n            }) \n            .catch(erro => {\n                console.log(erro)\n                this._mensagem.texto = erro;\n            })             \n     \n    }\n    \n    _criaNegociacao() {\n        \n        return new Negociacao(\n            DateHelper.textoParaData(this._inputData.value),\n            parseInt(this._inputQuantidade.value),\n            parseFloat(this._inputValor.value)\n            )  \n    }\n\n    ordenaNegociacao(coluna){\n            this._listaNegociacoes.ordena((a,b) => a[coluna] - b[coluna]);\n    }\n\n    _limpaFormulario() {\n     \n        this._inputData.value = '';\n        this._inputQuantidade.value = 1;\n        this._inputValor.value = 0.0;\n        this._inputData.focus();   \n    }\n}\n\nlet negociacaoController = new NegociacaoController();\n\nexport function currentInstance() {\n    return negociacaoController;\n}"],"mappings":"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"}